{% extends "app/base.html" %}
{% load static %}

{% block title %}GreenNest ‚Äì Organic Market{% endblock %}

{% block content %}



<!-- Hero -->
<section class="hero">
  <div class="container hero-wrap">
    <div class="hero-card">
      <span class="eyebrow">100% H·ªØu c∆° ‚Äì Giao nhanh trong ng√†y</span>
      <h1>ƒÇn s·∫°ch, s·ªëng xanh v·ªõi th·ª±c ph·∫©m <span style="color:var(--green)">ORGANIC</span></h1>
      <p>Ch·ªçn l·ªçc t·ª´ n√¥ng tr·∫°i ƒë·∫°t chu·∫©n, quy tr√¨nh l·∫°nh kh√©p k√≠n, nh√£n m√°c minh b·∫°ch.
         H√£y b·∫Øt ƒë·∫ßu gi·ªè h√†ng l√†nh m·∫°nh ngay h√¥m nay.</p>
      <div style="display:flex; gap:10px; margin-top:16px">
        <a class="btn btn-primary" href="{% url 'productlist' %}">Mua ngay</a>
        <a class="btn btn-ghost" href="{% url 'aboutus' %}">V√¨ sao ch·ªçn GreenNest?</a>
      </div>

      <div class="chips">
        <span class="chip">ü•¶ Rau c·ªß</span>
        <span class="chip">üçé Tr√°i c√¢y</span>
        <span class="chip">üåæ Ng≈© c·ªëc & h·∫°t</span>
        <span class="chip">ü•õ S·ªØa & ch·∫ø ph·∫©m</span>
      </div>

      <div class="highlights">
        <div class="badge"><span class="dot"></span>Canh t√°c kh√¥ng ho√° ch·∫•t</div>
        <div class="badge"><span class="dot" style="background:var(--orange)"></span>ƒê√≥ng g√≥i th√¢n thi·ªán</div>
        <div class="badge"><span class="dot" style="background:var(--brown)"></span>Truy xu·∫•t ngu·ªìn g·ªëc</div>
        <div class="badge"><span class="dot" style="background:#7e7e7e"></span>Ho√†n ti·ªÅn 100%</div>
      </div>
    </div>

    <div class="hero-visual">
      <div class="card">
        <div class="ph"></div>
        <div class="ph orange"></div>
        <div class="ph brown"></div>
        <div class="ph"></div>
      </div>
    </div>
  </div>
</section>

<!-- S·∫£n ph·∫©m m·ªõi -->
<section id="products" class="container">
  <div class="section-head">
    <h2>S·∫£n ph·∫©m m·ªõi</h2>
    <a class="btn" style="border:1px solid var(--gray); background:white" href="{% url 'productlist' %}">Xem t·∫•t c·∫£ ‚Üí</a>
  </div>
  <div class="grid">
    {% for product in new_products %}
    <article class="card">
      <a href="{% url 'productdetail' product.id %}" style="text-decoration:none; color:inherit;">
        <div class="thumb">
          {% if product.image %}
            <img src="{{ product.image.url }}" alt="{{ product.name }}" style="width:100%; height:200px; object-fit:cover;">
          {% else %}
            <div class="seed" aria-hidden="true"></div>
          {% endif %}
        </div>
        <div class="content">
          <div class="badge-row" style="display:flex; flex-wrap:wrap; gap:6px; align-items:center;">
            {% for cert in product.certifications.all %}
              <div class="pill"
                style="background: {{ cert.style_colors.bg }};
                      color: {{ cert.style_colors.text }};
                      border: 1px solid {{ cert.style_colors.border }};
                      font-size:13px;
                      padding:2px 8px;
                      border-radius:999px;">
                ‚Ä¢ {{ cert.name }}
            </div>
          {% endfor %}

          {% if product.sale %}
            <div class="pill"
              style="background:#FFEBEE;
                    color:#C62828;
                    border:1px solid #EF9A9A;
                    font-size:13px;
                    padding:2px 8px;
                    border-radius:999px;
                    font-weight:600;">
              Gi·∫£m {{ product.discount_percentage|floatformat:0 }}%
            </div>
          {% endif %}
        </div>


          <h3 style="margin:8px 0 6px">{{ product.name }}</h3>
          <p class="subtle">{{ product.description|truncatewords:12 }}</p>

          <div class="price" >
            {% if product.sale %}
              <strong>${{ product.final_price|floatformat:2 }}</strong>
            {% else %}
              <strong>${{ product.price }}</strong>
            {% endif %}

            <form method="post" action="{% url 'add_to_cart' product.id %}" class="add-to-cart-form">
              {% csrf_token %}
              <div class="add">
                <div class="qty">
                  <button type="button" class="qty-decrease">‚àí</button>
                  <span class="qty-display">1</span>
                  <button type="button" class="qty-increase">+</button>
                </div>
                <input type="hidden" name="quantity" value="1" class="qty-input">
                <button type="submit" class="btn-primary" style="padding:8px 12px">Th√™m</button>
              </div>
            </form>
          </div>
        </div>
      </a>
    </article>
    {% endfor %}
  </div>
</section>


{% if current_coupon %}
<section class="container">
  <div class="cta">
    <div class="left">
      <div class="leaf">%</div>
      <div>
        <h3 style="margin:0 0 4px; color:var(--green)">
          M√£ gi·∫£m gi√°: <strong id="couponCode">{{ current_coupon.code }}</strong>
        </h3>
        <p class="subtle">
          {{ current_coupon.description|default:"Nh·∫≠p m√£ ƒë·ªÉ ƒë∆∞·ª£c ∆∞u ƒë√£i ƒë·∫∑c bi·ªát!" }}
        </p>
      </div>
    </div>
    <button 
      class="btn btn-primary" 
      type="button" 
      onclick="copyCoupon()"
    >
      Sao ch√©p m√£
    </button>
  </div>
</section>
{% endif %}


<section id="about" class="container">
  <div class="section-head"><h2>Cam k·∫øt c·ªßa ch√∫ng t√¥i</h2></div>
  <div class="grid" style="grid-template-columns:repeat(3,1fr)">
    <div class="card" style="border-color:var(--gray)">
      <div class="content">
        <h3>Chu·ªói l·∫°nh & t∆∞∆°i s·∫°ch</h3>
        <p class="subtle">B·∫£o qu·∫£n 0‚Äì4¬∞C t·ª´ kho ƒë·∫øn tay b·∫°n. Bao b√¨ gi·∫•y t√°i ch·∫ø, m·ª±c in ƒë·∫≠u n√†nh.</p>
      </div>
    </div>
    <div class="card" style="border-color:var(--gray)">
      <div class="content">
        <h3>Truy xu·∫•t ngu·ªìn g·ªëc</h3>
        <p class="subtle">M·ªói s·∫£n ph·∫©m ƒë·ªÅu c√≥ m√£ l√¥, n√¥ng tr·∫°i, v√† ng√†y thu ho·∫°ch r√µ r√†ng.</p>
      </div>
    </div>
    <div class="card" style="border-color:var(--gray)">
      <div class="content">
        <h3>ƒê·ªïi tr·∫£ d·ªÖ d√†ng</h3>
        <p class="subtle">Kh√¥ng h√†i l√≤ng? Ho√†n ti·ªÅn 100% trong 48 gi·ªù, kh√¥ng c·∫ßn gi·∫£i th√≠ch.</p>
      </div>
    </div>
  </div>
</section>

<script src="{% static 'app/js/home.js' %}"></script>

<script>
  function copyCoupon() {
    const code = document.getElementById('couponCode').innerText;
    navigator.clipboard.writeText(code);
    alert(`ƒê√£ sao ch√©p m√£: ${code}`);
  }
</script>

{% endblock %}
