{% extends "app/base.html" %}
{% load static %}
{% block title %}GreenNest – Organic Market{% endblock %}

{% block content %}

<style>
.progress-step.done .circle {
  background: var(--green);
  border-color: var(--green);
}

</style>


  <section class="container order-wrapper">
    <!-- Left -->
    <div class="order-card">
      <h2>Đơn hàng {{ order.id }}</h2>
      <div class="order-status">
        <p><strong>Ngày đặt:</strong> {{ order.date_order|date:"d/m/Y H:i" }}</p>
        <p><strong>Trạng thái:</strong> {{ order.get_status_display }}</p>
        <div class="progress">
          <div class="progress-step {{ s1 }}"><div class="circle"></div><p>Đã đặt</p></div>
          <div class="progress-step {{ s2 }}"><div class="circle"></div><p>Đang xử lý</p></div>
          <div class="progress-step {{ s3 }}"><div class="circle"></div><p>Đã xác nhận</p></div>
          <div class="progress-step {{ s4 }}"><div class="circle"></div><p>Hoàn tất</p></div>
        </div>
      </div>
      <table class="order-table">
        <thead>
          <tr><th>Sản phẩm</th><th>SL</th><th>Giá</th><th>Tổng</th></tr>
        </thead>
        <tbody>
        {% for item in order.orderitem_set.all %}
          <tr>
            <td>
              {% if item.product %}
                {{ item.product.name }}
              {% elif item.combo %}
                {{ item.combo.name }}
                <span class="combo-tag">Combo</span>
              {% endif %}
            </td>
            <td>{{ item.quantity }}</td>
            <td>${{ item.price|floatformat:2 }}</td>
            <td>${{ item.get_total|floatformat:2 }}</td>
          </tr>
        {% empty %}
          <tr><td colspan="4" class="subtle">Không có sản phẩm nào trong đơn hàng.</td></tr>
        {% endfor %}
      </tbody>
      </table>
    </div>

    <!-- Right -->
    <div class="order-card">
      <h2>Tóm tắt</h2>
      <div class="summary-row"><span>Tạm tính</span><span>${{ order.get_cart_total|floatformat:2 }}</span></div>
      <div class="summary-row"><span>Phí ship</span><span>{% if order.delivery %} {{ order.delivery.get_status_display }} {% else %}Miễn phí{% endif %}</span></div>
      <div class="summary-row">
        <span>Thanh toán:</span>
        <span>
          {% if order.payment %}
            {{ order.payment.get_status_display }}
          {% else %}
            Chưa có thanh toán
          {% endif %}
        </span>
      </div>

      <div class="summary-row"><strong>Tổng cộng</strong><strong>${{ order.get_cart_total|floatformat:2 }}</strong></div>
      
    </div>
  </section>

{% endblock %}
